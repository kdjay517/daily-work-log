<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Work Log Tracker - Enhanced v2.1</title>
    <meta name="description" content="Professional daily work log tracker with analytics, monthly summary, and advanced export features">
    <meta name="keywords" content="work log, time tracking, project management, daily tracker, analytics">
    <meta name="author" content="Work Log Tracker Team">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3Eüìä%3C/text%3E%3C/svg%3E">
    
    <!-- Preload critical CSS -->
    <link rel="preload" href="style.css" as="style">
    <link rel="stylesheet" href="style.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    
    <!-- Theme and Performance -->
    <meta name="theme-color" content="#2180bd">
    <meta name="color-scheme" content="light dark">
    
    <!-- Performance Hints -->
    <link rel="dns-prefetch" href="https://www.gstatic.com">
    <link rel="preconnect" href="https://www.gstatic.com" crossorigin>
</head>
<body class="loading">
    <!-- Skip Navigation Link for Accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <!-- Loading Indicator -->
    <div id="loadingIndicator" class="loading-indicator">
        <div class="loading-spinner"></div>
        <p>Loading Work Log Tracker...</p>
        <small>Initializing application components...</small>
    </div>

    <!-- Authentication Screen -->
    <div id="authScreen" class="auth-screen">
        <div class="auth-container">
            <div class="auth-header">
                <h1>üìä Daily Work Log Tracker</h1>
                <p>Professional time tracking with analytics and reporting</p>
                <small class="version-info">Version 2.1 - Enhanced Analytics</small>
            </div>

            <!-- Auth Tabs -->
            <div class="auth-tabs" role="tablist" aria-label="Authentication options">
                <button id="loginTab" class="auth-tab active" role="tab" aria-selected="true" aria-controls="loginForm">
                    Login
                </button>
                <button id="registerTab" class="auth-tab" role="tab" aria-selected="false" aria-controls="registerForm">
                    Register
                </button>
                <button id="guestTab" class="auth-tab" role="tab" aria-selected="false" aria-controls="guestForm">
                    Guest Mode
                </button>
            </div>

            <!-- Login Form -->
            <div id="loginForm" class="auth-form" role="tabpanel" aria-labelledby="loginTab">
                <div class="form-group">
                    <label for="loginEmail">Email Address</label>
                    <input type="email" id="loginEmail" placeholder="Enter your email address" 
                           required autocomplete="email" aria-describedby="loginErrors">
                </div>
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" placeholder="Enter your password" 
                           required autocomplete="current-password" aria-describedby="loginErrors">
                </div>
                <div id="loginErrors" class="auth-errors" role="alert" aria-live="polite"></div>
                <button id="loginBtn" class="btn btn--primary btn--full" type="button">
                    <span class="btn-icon">üîë</span>
                    <span class="btn-text">Sign In</span>
                </button>
            </div>

            <!-- Register Form -->
            <div id="registerForm" class="auth-form hidden" role="tabpanel" aria-labelledby="registerTab">
                <div class="form-group">
                    <label for="registerName">Full Name</label>
                    <input type="text" id="registerName" placeholder="Enter your full name" 
                           required autocomplete="name" aria-describedby="registerErrors">
                </div>
                <div class="form-group">
                    <label for="registerEmail">Email Address</label>
                    <input type="email" id="registerEmail" placeholder="Enter your email address" 
                           required autocomplete="email" aria-describedby="registerErrors">
                </div>
                <div class="form-group">
                    <label for="registerPassword">Password</label>
                    <input type="password" id="registerPassword" placeholder="Create a password (min 6 characters)" 
                           required autocomplete="new-password" aria-describedby="registerErrors" minlength="6">
                </div>
                <div class="form-group">
                    <label for="confirmPassword">Confirm Password</label>
                    <input type="password" id="confirmPassword" placeholder="Confirm your password" 
                           required autocomplete="new-password" aria-describedby="registerErrors">
                </div>
                <div id="registerErrors" class="auth-errors" role="alert" aria-live="polite"></div>
                <button id="registerBtn" class="btn btn--primary btn--full" type="button">
                    <span class="btn-icon">‚ú®</span>
                    <span class="btn-text">Create Account</span>
                </button>
            </div>

            <!-- Guest Form -->
            <div id="guestForm" class="auth-form hidden" role="tabpanel" aria-labelledby="guestTab">
                <div class="guest-info">
                    <h3>Continue as Guest</h3>
                    <p>Experience all features with local data storage only.</p>
                    <div class="guest-features">
                        <div class="feature-list">
                            <h4>‚úÖ Available Features:</h4>
                            <ul class="guest-limitations">
                                <li>‚úÖ Full application functionality</li>
                                <li>‚úÖ Monthly summary & analytics</li>
                                <li>‚úÖ Historical data tracking</li>
                                <li>‚úÖ Advanced export options</li>
                                <li>‚úÖ Project management</li>
                                <li>‚úÖ Data backup & restore</li>
                            </ul>
                        </div>
                        <div class="limitations-list">
                            <h4>‚ö†Ô∏è Limitations:</h4>
                            <ul class="guest-limitations">
                                <li>‚ö†Ô∏è Data stored locally only</li>
                                <li>‚ö†Ô∏è No cross-device synchronization</li>
                                <li>‚ö†Ô∏è Manual backup required</li>
                                <li>‚ö†Ô∏è No cloud storage</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <button id="continueGuestBtn" class="btn btn--secondary btn--full" type="button">
                    <span class="btn-icon">üë§</span>
                    <span class="btn-text">Continue as Guest</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp" class="main-app hidden">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <div class="header-brand">
                    <h1>üìä Work Log Tracker</h1>
                    <small class="version">v2.1 Enhanced</small>
                </div>
                <div class="user-info">
                    <div class="user-details">
                        <span id="userWelcome" class="user-welcome">Welcome!</span>
                        <span id="userMode" class="status status--info">Enhanced Mode</span>
                    </div>
                    <div class="header-actions">
                        <button id="analyticsBtn" class="btn btn--outline" aria-label="View analytics dashboard">
                            <span class="btn-icon">üìà</span>
                            <span class="btn-text">Analytics</span>
                        </button>
                        <button id="exportBtn" class="btn btn--outline" aria-label="Export data options">
                            <span class="btn-icon">üìÅ</span>
                            <span class="btn-text">Export</span>
                        </button>
                        <button id="manageProjectsBtn" class="btn btn--outline" aria-label="Manage projects">
                            <span class="btn-icon">‚öôÔ∏è</span>
                            <span class="btn-text">Projects</span>
                        </button>
                        <button id="logoutBtn" class="btn btn--secondary" aria-label="Logout">
                            <span class="btn-icon">üëã</span>
                            <span class="btn-text">Logout</span>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content Grid -->
        <main id="main-content" class="main-dashboard">
            <!-- Calendar Section -->
            <section class="calendar-section" aria-labelledby="calendar-heading">
                <div class="section-header">
                    <h2 id="calendar-heading">üìÖ Work Calendar</h2>
                    <p>Select a date to manage your work entries</p>
                </div>

                <!-- Legend -->
                <div class="calendar-legend">
                    <div class="legend-item">
                        <span class="legend-indicator work-logged"></span>
                        <span>Work Logged</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-indicator today"></span>
                        <span>Today</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-indicator holiday-leave"></span>
                        <span>Holiday/Leave</span>
                    </div>
                </div>

                <!-- Month Navigation -->
                <nav class="month-navigation" aria-label="Month navigation">
                    <button id="prevMonthBtn" class="nav-btn" aria-label="Previous month">
                        <span aria-hidden="true">‚Äπ</span>
                    </button>
                    <h3 id="currentMonth" class="current-month">October 2025</h3>
                    <button id="nextMonthBtn" class="nav-btn" aria-label="Next month">
                        <span aria-hidden="true">‚Ä∫</span>
                    </button>
                </nav>

                <!-- Calendar Grid -->
                <div class="calendar-container">
                    <div class="calendar-weekdays" role="row">
                        <div class="weekday" role="columnheader">Sun</div>
                        <div class="weekday" role="columnheader">Mon</div>
                        <div class="weekday" role="columnheader">Tue</div>
                        <div class="weekday" role="columnheader">Wed</div>
                        <div class="weekday" role="columnheader">Thu</div>
                        <div class="weekday" role="columnheader">Fri</div>
                        <div class="weekday" role="columnheader">Sat</div>
                    </div>
                    <div id="calendarGrid" class="calendar-grid" role="grid" aria-label="Calendar days">
                        <!-- Calendar days will be generated by JavaScript -->
                    </div>
                </div>
            </section>

            <!-- Daily Entry Section -->
            <section class="daily-entry-section" aria-labelledby="daily-entry-heading">
                <div class="section-header">
                    <h2 id="daily-entry-heading">üìù Daily Entry</h2>
                    <p id="selectedDateInfo">Select a date to log work</p>
                </div>

                <!-- Entry Form -->
                <form id="entryForm" class="entry-form" style="display: none;" novalidate>
                    <div class="form-header">
                        <h4>Add New Entry</h4>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="entryType">Entry Type *</label>
                            <select id="entryType" required>
                                <option value="">Select entry type...</option>
                                <option value="work">üîß Work Entry</option>
                                <option value="fullLeave">üèñÔ∏è Full Day Leave</option>
                                <option value="halfLeave">‚è∞ Half Day Leave</option>
                                <option value="holiday">üéâ Holiday</option>
                            </select>
                        </div>
                    </div>

                    <div id="projectGroup" class="form-group" style="display: none;">
                        <label for="project">Project *</label>
                        <select id="project">
                            <option value="">Select project...</option>
                        </select>
                    </div>

                    <div id="hoursGroup" class="form-group" style="display: none;">
                        <label for="hours">Hours *</label>
                        <input type="number" id="hours" min="0.5" max="8" step="0.5" 
                               placeholder="Enter hours (0.5 - 8)">
                    </div>

                    <div id="halfDayPeriodGroup" class="form-group" style="display: none;">
                        <label for="halfDayPeriod">Time Period *</label>
                        <select id="halfDayPeriod">
                            <option value="">Select period...</option>
                            <option value="morning">üåÖ Morning (8:00 AM - 12:00 PM)</option>
                            <option value="afternoon">üåÜ Afternoon (1:00 PM - 5:00 PM)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="comments">Comments</label>
                        <textarea id="comments" rows="3" placeholder="Add any additional notes..." maxlength="500"></textarea>
                    </div>

                    <div id="formErrors" class="form-errors" role="alert" aria-live="polite"></div>

                    <div class="form-actions">
                        <button id="addEntryBtn" class="btn btn--primary" type="button">
                            <span class="btn-icon">‚ûï</span>
                            <span class="btn-text">Add Entry</span>
                        </button>
                        <button id="cancelEntryBtn" class="btn btn--outline" type="button" style="display: none;">
                            <span class="btn-icon">‚ùå</span>
                            <span class="btn-text">Cancel</span>
                        </button>
                    </div>
                </form>

                <!-- Daily Entries List -->
                <div class="daily-entries">
                    <div id="entriesList" class="entries-list" role="region" aria-label="Daily entries list">
                        <div class="no-entries">
                            <span class="no-entries-icon">üìù</span>
                            <p>No entries for selected date</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Monthly Summary Section -->
            <section class="monthly-summary-section" aria-labelledby="monthly-summary-heading">
                <div class="section-header">
                    <h2 id="monthly-summary-heading">üìä Monthly Summary</h2>
                </div>

                <div class="summary-grid">
                    <div class="summary-card">
                        <div class="summary-value" id="daysWorked">0</div>
                        <div class="summary-label">Days Worked</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-value" id="totalHours">0.00</div>
                        <div class="summary-label">Total Hours</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-value" id="avgHours">0.00</div>
                        <div class="summary-label">Avg Hours/Day</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-value" id="totalEntries">0</div>
                        <div class="summary-label">Total Entries</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-value" id="uniqueProjects">0</div>
                        <div class="summary-label">Unique Projects</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-value" id="monthProgress">0.0%</div>
                        <div class="summary-label">Month Progress</div>
                    </div>
                </div>
            </section>

            <!-- Historical Data Section -->
            <section class="historical-data-section" aria-labelledby="historical-heading">
                <div class="section-header">
                    <h2 id="historical-heading">üìà Historical Data</h2>
                </div>

                <div id="historicalList" class="historical-list">
                    <!-- Historical data will be populated by JavaScript -->
                </div>
            </section>

            <!-- Export Options Section -->
            <section class="export-section" aria-labelledby="export-heading">
                <div class="section-header">
                    <h2 id="export-heading">üíæ Export Options</h2>
                </div>

                <div class="export-grid">
                    <button id="exportCurrentMonthBtn" class="export-btn">
                        <span class="export-icon">üìÑ</span>
                        <div class="export-content">
                            <h4>Current Month</h4>
                            <p>Export this month's data as CSV</p>
                        </div>
                    </button>
                    
                    <button id="exportAllDataBtn" class="export-btn">
                        <span class="export-icon">üìä</span>
                        <div class="export-content">
                            <h4>All Data</h4>
                            <p>Export complete work log as CSV</p>
                        </div>
                    </button>
                    
                    <button id="exportBackupBtn" class="export-btn">
                        <span class="export-icon">üíæ</span>
                        <div class="export-content">
                            <h4>Data Backup</h4>
                            <p>Create complete JSON backup</p>
                        </div>
                    </button>
                    
                    <button id="importBackupBtn" class="export-btn">
                        <span class="export-icon">üì•</span>
                        <div class="export-content">
                            <h4>Restore Backup</h4>
                            <p>Import data from backup file</p>
                        </div>
                    </button>
                </div>

                <div class="export-status">
                    <span id="guestModeNotice" class="guest-notice">
                        Using guest mode - data stored locally only
                    </span>
                </div>
            </section>
        </main>
    </div>

    <!-- Analytics Modal -->
    <div id="analyticsModal" class="modal-overlay hidden" role="dialog" aria-labelledby="analyticsModalTitle" aria-modal="true">
        <div class="modal-content modal-content--large">
            <div class="modal-header">
                <h3 id="analyticsModalTitle">üìà Analytics Dashboard</h3>
                <button id="closeAnalyticsBtn" class="close-btn" aria-label="Close analytics dashboard">
                    <span aria-hidden="true">√ó</span>
                </button>
            </div>
            
            <div class="modal-body">
                <div class="analytics-tabs">
                    <button class="analytics-tab active" data-tab="overview">Overview</button>
                    <button class="analytics-tab" data-tab="productivity">Productivity</button>
                    <button class="analytics-tab" data-tab="projects">Projects</button>
                </div>
                
                <div id="analyticsContent" class="analytics-content">
                    <!-- Analytics content will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Project Management Modal -->
    <div id="projectModal" class="modal-overlay hidden" role="dialog" aria-labelledby="projectModalTitle" aria-modal="true">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="projectModalTitle">‚öôÔ∏è Manage Projects</h3>
                <button id="closeProjectModalBtn" class="close-btn" aria-label="Close project management dialog">
                    <span aria-hidden="true">√ó</span>
                </button>
            </div>
            
            <div class="modal-body">
                <!-- Project management content -->
                <form class="project-form" novalidate>
                    <h4>Add New Project</h4>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="newProjectId">Project ID *</label>
                            <input type="text" id="newProjectId" placeholder="e.g., WV-1112-4152" 
                                   required maxlength="50">
                        </div>
                        <div class="form-group">
                            <label for="newSubCode">Sub Code *</label>
                            <input type="text" id="newSubCode" placeholder="e.g., 0210" 
                                   required maxlength="20">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="newProjectTitle">Project Title *</label>
                        <input type="text" id="newProjectTitle" placeholder="e.g., AS_Strategy" 
                               required maxlength="100">
                    </div>
                    
                    <div class="form-group">
                        <label for="newProjectCategory">Category *</label>
                        <select id="newProjectCategory" required>
                            <option value="">Select category...</option>
                            <option value="Strategy">üìã Strategy</option>
                            <option value="Development">üíª Development</option>
                            <option value="Testing">üß™ Testing</option>
                            <option value="Controller">üéõÔ∏è Controller</option>
                            <option value="Tracking">üìä Tracking</option>
                            <option value="Overhead">üìà Overhead</option>
                            <option value="Research">üî¨ Research</option>
                            <option value="Maintenance">üîß Maintenance</option>
                            <option value="Documentation">üìù Documentation</option>
                            <option value="Training">üéì Training</option>
                        </select>
                    </div>
                    
                    <div id="projectFormErrors" class="form-errors" role="alert" aria-live="polite"></div>
                    
                    <button id="addProjectBtn" class="btn btn--primary" type="button">
                        <span class="btn-icon">‚ûï</span>
                        <span class="btn-text">Add Project</span>
                    </button>
                </form>

                <!-- Projects List -->
                <div class="projects-list">
                    <div class="projects-header">
                        <h4>Existing Projects</h4>
                        <span id="projectsCount" class="projects-count">0 projects</span>
                    </div>
                    <div id="projectsList" role="region" aria-label="Projects list">
                        <!-- Projects will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Export Modal -->
    <div id="exportModal" class="modal-overlay hidden" role="dialog" aria-labelledby="exportModalTitle" aria-modal="true">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="exportModalTitle">üìÅ Export Data</h3>
                <button id="closeExportModalBtn" class="close-btn" aria-label="Close export dialog">
                    <span aria-hidden="true">√ó</span>
                </button>
            </div>
            
            <div class="modal-body">
                <div class="export-options">
                    <h4>Select Export Format & Range</h4>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="exportFormat">Export Format</label>
                            <select id="exportFormat">
                                <option value="csv">üìÑ CSV (Spreadsheet)</option>
                                <option value="json">üìã JSON (Data)</option>
                                <option value="pdf">üìë PDF (Report)</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="exportRange">Date Range</label>
                            <select id="exportRange">
                                <option value="current-month">Current Month</option>
                                <option value="last-month">Last Month</option>
                                <option value="last-3-months">Last 3 Months</option>
                                <option value="all-data">All Data</option>
                                <option value="custom">Custom Range</option>
                            </select>
                        </div>
                    </div>
                    
                    <div id="customDateRange" class="form-row" style="display: none;">
                        <div class="form-group">
                            <label for="exportStartDate">Start Date</label>
                            <input type="date" id="exportStartDate">
                        </div>
                        <div class="form-group">
                            <label for="exportEndDate">End Date</label>
                            <input type="date" id="exportEndDate">
                        </div>
                    </div>
                    
                    <div class="export-actions">
                        <button id="executeExportBtn" class="btn btn--primary">
                            <span class="btn-icon">üì•</span>
                            <span class="btn-text">Export Data</span>
                        </button>
                        <button id="cancelExportBtn" class="btn btn--outline">
                            <span class="btn-text">Cancel</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Hidden File Input for Import -->
    <input type="file" id="backupFileInput" accept=".json" style="display: none;">

    <!-- Toast Notification -->
    <div id="toast" class="toast hidden" role="alert" aria-live="polite" aria-atomic="true">
        <div class="toast-content">
            <span id="toastIcon" class="toast-icon"></span>
            <span id="toastMessage" class="toast-message"></span>
            <button id="toastClose" class="toast-close" aria-label="Close notification">
                <span aria-hidden="true">√ó</span>
            </button>
        </div>
    </div>

    <!-- JavaScript Modules -->
    <script type="module" src="config/firebase.js" defer></script>
    <script type="module" src="models/User.js" defer></script>
    <script type="module" src="models/WorkEntry.js" defer></script>
    <script type="module" src="models/Project.js" defer></script>
    <script type="module" src="services/DataService.js" defer></script>
    <script type="module" src="services/AnalyticsService.js" defer></script>
    <script type="module" src="services/ExportService.js" defer></script>
    <script type="module" src="views/CalendarView.js" defer></script>
    <script type="module" src="views/AnalyticsView.js" defer></script>
    <script type="module" src="controllers/AuthController.js" defer></script>
    <script type="module" src="controllers/EntryController.js" defer></script>
    <script type="module" src="controllers/ProjectController.js" defer></script>
    <script type="module" src="controllers/AnalyticsController.js" defer></script>
    <script type="module" src="controllers/ExportController.js" defer></script>
    <script type="module" src="controllers/ToastController.js" defer></script>
    <script type="module" src="main.js" defer></script>

    <!-- Analytics (placeholder) -->
    <script>
        window.trackEvent = function(event, data) {
            console.log('Analytics:', event, data);
        };
    </script>

    <!-- No-JS Fallback -->
    <noscript>
        <div style="padding: 2rem; max-width: 600px; margin: 2rem auto; background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; text-align: center;">
            <h2 style="color: #dc3545;">‚ö†Ô∏è JavaScript Required</h2>
            <p>This application requires JavaScript to function properly.</p>
            <p>Please enable JavaScript in your browser settings and refresh the page.</p>
        </div>
    </noscript>
</body>
</html>
